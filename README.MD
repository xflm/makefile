# 简介

这里我将介绍一个我日常使用的makefile框架，我本人开发单片机裸机程序较多，故这里分享给大家的makefile主要偏向于裸机开发，适合新人上手，但其中有一些技巧我觉得有一定的参考价值。

# 文件

> $ tree  
.  
├── README.MD　　　　　　　　　　　　- - - 说明文档  
├── linux　　　　　　　　　　　　　　- - - 编译Linux程序模板  
│　　├── Makefile　　　　　　　　　- - -  配置文件  
│　　├── file.mk　　　　　　　　　　- - - 列表文件  
│　　├── main.c　　　　　　　　　　- - -  源码文件  
│　　└── tools  
│　　 　　└── bash　　　　　　　　　- - - 辅助脚本  
│　　 　　│　 └── create.sh　　　　- - -  工程拷贝  
│　　 　　└── make　　　　　　　　　- - - 辅助脚本  
│　　 　　 　　├── clone.mk　　　　- - -  工程拷贝  
│　　 　　 　　├── create.mk　　　　- - - 工程构造  
│　　 　　 　　├── files.mk　　　　- - -  打印文件列表  
│　　 　　 　　├── help.mk　　　　　- - - 打印帮助文档  
│　　 　　 　　├── lib.mk　　　　　- - -  编译静态库，被file.mk调用  
│　　 　　 　　├── make.mk　　　　　- - - 主要编译规则文件  
│　　 　　 　　├── makefile　　　　- - -  启用make编译的模板  
│　　 　　 　　├── qt.mk　　　　　　- - - 生成Qt工程文件  
│　　 　　 　　├── slim.mk　　　　　- - - 清除不使用的C文件  
│　　 　　 　　└── tags.mk　　　　　- - - 给工程文件打标签  
└── mcu　　　　　　　　　　　　　　　- - - 编译裸机程序模板  
　　├── drivers　　　　　　　　　　　- - - 工程目录外的文件  
　　└── stm32f072　　　　　　　　　　- - - 工程目录  
　　　　├── Makefile  
　　　　├── apps　　　　　　　　　　- - -  工程源码  
　　　　├── arch　　　　　　　　　　- - -  裸机相关的文件  
　　　　│　　├── crt0.S　　　　　　- - -  启动汇编  
　　　　│　　└── ram.lds　　　　　　- - - 链接脚本  
　　　　├── drivers　　　　　　　　　- - - 用于引用外部目录的文件  
　　　　│　　├── file.mk  
　　　　│　　└── makefile　　　　　- - -  用于使能子make编译静态库  
　　　　├── file.mk  
　　　　├── main.c  
　　　　└── tools  

# 功能

 - 支持在Linux和Windows(git-bash)上运行
 - 支持通过BASH脚本创建工程
 - 支持编译同名文件
 - 支持编译工程目录之外的文件（绝对路径或相对路径）
 - 支持单独编译静态库
 - 支持编译静态库，并使用静态库链接成可执行文件
 - 支持单独指定编译静态库的参数
 - 支持生成多种类型文件：反汇编文件、二进制文件、HEX文件、MAP文件等
 - 支持在执行编译前和编译后调用用户命令
 - 支持打印链接完成后存储器使用情况（需链接脚本配合）
 - 支持打印参与编译的文件列表
 - 支持对所有参与编译的文件执行ctags
 - 支持工程拷贝，工程拷贝时会创建一个新的工程，并将目录外的文件拷贝到目录内，删除不参与编译的头文件
 - 支持工程瘦身，即移除参与编译但不会被使用到的C文件
 - 支持生成Qtcreator的工程文件，可以使用Qt进行源码的编辑

# 约束

目前该makefile仅支持`.c` `.S` `.a` `.h`四种后缀的文件，`.C` `.s` `.H`文件并不支持。

***
详细介绍参考：[一个有惊喜的makefile](https://blog.csdn.net/qq_37858281/article/details/113823231)
